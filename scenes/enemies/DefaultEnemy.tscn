[gd_scene load_steps=27 format=3 uid="uid://djj2jwexpvc0p"]

[ext_resource type="PackedScene" uid="uid://btw78yl2xtnas" path="res://models/enemies/DefaultEnemy/default_enemy.glb" id="1"]
[ext_resource type="Script" path="res://src/Core/Enemies/DefaultEnemy.cs" id="2"]
[ext_resource type="Script" path="res://src/Core/Audio/SfxOptions.cs" id="3"]
[ext_resource type="FontFile" path="res://assets/fonts/secondary/secondary_bold_outline.tres" id="4"]
[ext_resource type="Resource" path="res://resources/default_enemy_screams_streams.tres" id="5"]

[sub_resource type="SphereShape3D" id="16"]
radius = 14.7219

[sub_resource type="CapsuleShape3D" id="1"]
radius = 2.62381
height = 11.657

[sub_resource type="AnimationNodeAnimation" id="2"]
animation = &"mutant_long_attack"

[sub_resource type="AnimationNodeAnimation" id="3"]
animation = &"mutant_look_around"

[sub_resource type="AnimationNodeAnimation" id="4"]
animation = &"idle_react"

[sub_resource type="AnimationNodeAnimation" id="5"]
animation = &"biting_neck"

[sub_resource type="AnimationNodeAnimation" id="6"]
animation = &"bittingloop"

[sub_resource type="AnimationNodeOneShot" id="7"]

[sub_resource type="AnimationNodeOneShot" id="8"]

[sub_resource type="AnimationNodeOneShot" id="9"]

[sub_resource type="AnimationNodeOneShot" id="10"]

[sub_resource type="AnimationNodeBlend2" id="11"]

[sub_resource type="AnimationNodeAnimation" id="12"]
animation = &"crawlingloop"

[sub_resource type="AnimationNodeAnimation" id="13"]
animation = &"mutant_walkloop"

[sub_resource type="AnimationNodeBlendSpace1D" id="14"]
blend_point_0/node = SubResource("12")
blend_point_0/pos = 1.0
blend_point_1/node = SubResource("13")
blend_point_1/pos = -1.0

[sub_resource type="AnimationNodeTimeScale" id="17"]

[sub_resource type="AnimationNodeBlendTree" id="15"]
graph_offset = Vector2(-804, -23)
nodes/Animation/node = SubResource("6")
nodes/Animation/position = Vector2(-560, 60)
"nodes/Animation 2/node" = SubResource("2")
"nodes/Animation 2/position" = Vector2(520, 320)
"nodes/Animation 3/node" = SubResource("3")
"nodes/Animation 3/position" = Vector2(-20, 300)
"nodes/Animation 4/node" = SubResource("4")
"nodes/Animation 4/position" = Vector2(280, 300)
"nodes/Animation 5/node" = SubResource("5")
"nodes/Animation 5/position" = Vector2(780, 300)
nodes/bitting_neck/node = SubResource("7")
nodes/bitting_neck/position = Vector2(780, 140)
nodes/idle_react/node = SubResource("8")
nodes/idle_react/position = Vector2(280, 140)
nodes/long_attack/node = SubResource("9")
nodes/long_attack/position = Vector2(540, 140)
nodes/look_around/node = SubResource("10")
nodes/look_around/position = Vector2(40, 140)
nodes/motion/node = SubResource("11")
nodes/motion/position = Vector2(-320, 120)
nodes/output/position = Vector2(980, 20)
nodes/space_motion/node = SubResource("14")
nodes/space_motion/position = Vector2(-600, 300)
nodes/time_scale_motion/node = SubResource("17")
nodes/time_scale_motion/position = Vector2(-600, 200)
node_connections = [&"output", 0, &"bitting_neck", &"bitting_neck", 0, &"long_attack", &"bitting_neck", 1, &"Animation 5", &"idle_react", 0, &"look_around", &"idle_react", 1, &"Animation 4", &"long_attack", 0, &"idle_react", &"long_attack", 1, &"Animation 2", &"look_around", 0, &"motion", &"look_around", 1, &"Animation 3", &"motion", 0, &"Animation", &"motion", 1, &"time_scale_motion", &"time_scale_motion", 0, &"space_motion"]

[sub_resource type="ConvexPolygonShape3D" id="18"]
points = PackedVector3Array(36, 10, 36, -36, 10, 36, 0, 2, 0, 36, -5, 36, -36, -5, 36, 0, 0, 0)

[sub_resource type="ConvexPolygonShape3D" id="19"]
points = PackedVector3Array(80, 10, 80, -80, 10, 80, 0, 2, 0, 80, -5, 80, -80, -5, 80, 0, 0, 0)

[sub_resource type="StandardMaterial3D" id="21"]
transparency = 1
no_depth_test = true
shading_mode = 0
disable_ambient_light = true
disable_receive_shadows = true
billboard_mode = 3
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="QuadMesh" id="20"]
size = Vector2(4, 2)

[node name="DefaultEnemy" type="CharacterBody3D"]
collision_mask = 13
script = ExtResource("2")
aimRayPath = NodePath("RayCastsOrigin/AimRay")
topRayPath = NodePath("RayCastsOrigin/Top")
bottomRayPath = NodePath("RayCastsOrigin/Bottom")
rightRayPath = NodePath("RayCastsOrigin/Right")
leftRayPath = NodePath("RayCastsOrigin/Left")
forwardRayPath = NodePath("RayCastsOrigin/Forward")
backwardRayPath = NodePath("RayCastsOrigin/Backward")
patrolSpeed = 10.0
chasingSpeed = 12.0
huntingSpeed = 14.0
animationTreePath = NodePath("AnimationTree")
sfxPath = NodePath("Sfx")
navigationAgentPath = NodePath("NavigationAgent3D")
closeSightPath = NodePath("CloseSight")
farSightPath = NodePath("FarSight")
headPath = NodePath("default_enemy/Armature/Skeleton3D/Head/HeadSensor")
playerMask = 1032
viewportDebugPath = NodePath("Debug/SubViewport")
labelDebugPath = NodePath("Debug/SubViewport/Label")
meshDebugPath = NodePath("Debug")
rangeToAttack = 8.0
timeAttack = 1.85
attackDamage = 0.1

[node name="default_enemy" parent="." instance=ExtResource("1")]
transform = Transform3D(-0.5, 0, -4.37114e-08, 0, 0.5, 0, 4.37114e-08, 0, -0.5, 0, 0, 0)

[node name="Skeleton3D" parent="default_enemy/Armature" index="0"]
bones/0/position = Vector3(-4.43282, 3.98949, -42.7275)
bones/0/rotation = Quaternion(-0.0622379, -0.213177, 0.107099, 0.96913)
bones/1/rotation = Quaternion(0.0598683, 0.00096282, -0.0305009, 0.99774)
bones/2/rotation = Quaternion(0.00731035, 0.00046225, 0.00366949, 0.999966)
bones/3/rotation = Quaternion(0.0082093, 0.000165346, 0.00604553, 0.999948)
bones/4/position = Vector3(3.8147e-06, 16.7736, 6.03495e-07)
bones/4/rotation = Quaternion(-0.0998523, 0.0243745, 0.000723287, 0.994703)
bones/5/rotation = Quaternion(-0.338934, 0.132121, -0.0944883, 0.926682)
bones/7/position = Vector3(8.08028, 14.6528, -0.596549)
bones/7/rotation = Quaternion(-0.449705, -0.59923, 0.316477, -0.581835)
bones/8/position = Vector3(1.66893e-06, 16.939, -2.5034e-06)
bones/8/rotation = Quaternion(-0.0740895, -0.519624, 0.13249, 0.840802)
bones/9/rotation = Quaternion(0.0393665, -0.000117743, 0.382105, 0.92328)
bones/10/position = Vector3(2.44901e-07, 36.4289, 2.75675e-06)
bones/10/rotation = Quaternion(-0.245532, 0.133979, -0.0866401, 0.956168)
bones/11/rotation = Quaternion(-0.0104254, -0.0025509, 0.372936, 0.927795)
bones/12/position = Vector3(-0.347108, 4.38919, 1.04248e-05)
bones/12/rotation = Quaternion(-0.0143545, 0.0188033, -0.042367, 0.998822)
bones/13/position = Vector3(0.380829, 4.32737, 9.0067e-06)
bones/13/rotation = Quaternion(-0.151522, 0.01891, -0.0572619, 0.986613)
bones/14/position = Vector3(-0.0337137, 3.7039, -2.12342e-05)
bones/15/rotation = Quaternion(-0.0285864, 0.0159099, 0.144129, 0.989018)
bones/16/position = Vector3(-0.00427252, 3.94223, 1.51828e-05)
bones/16/rotation = Quaternion(8.69186e-07, 9.96282e-06, 0.00143165, 0.999999)
bones/17/position = Vector3(0.00651735, 3.66636, 1.72076e-06)
bones/17/rotation = Quaternion(-3.86593e-07, -1.04422e-05, -0.00124226, 0.999999)
bones/19/position = Vector3(-1.35539, 11.8203, -0.396462)
bones/19/rotation = Quaternion(-0.0297519, -0.00322163, 0.0386787, 0.998804)
bones/20/rotation = Quaternion(3.19385e-07, -1.54926e-05, -0.000730689, 1)
bones/21/rotation = Quaternion(-8.27211e-07, 4.14362e-05, -0.00194706, 0.999998)
bones/22/position = Vector3(-0.0105896, 3.23545, 1.77622e-05)
bones/23/position = Vector3(1.39386, 12.0822, -0.243429)
bones/23/rotation = Quaternion(-0.0225235, -0.00349105, -0.0284273, 0.999336)
bones/24/position = Vector3(-0.010499, 3.64698, 5.6823e-07)
bones/24/rotation = Quaternion(0.000168451, -3.02163e-05, 0.00157773, 0.999999)
bones/25/rotation = Quaternion(-0.0419387, 0.000112898, 0.00505487, 0.999107)
bones/26/position = Vector3(0.00950527, 2.93704, -9.56654e-06)
bones/27/position = Vector3(4.0155, 10.6944, 0.0867029)
bones/27/rotation = Quaternion(-0.0154307, -0.0267803, -0.0838776, 0.995997)
bones/28/rotation = Quaternion(0.000171489, 1.42469e-05, 0.00194903, 0.999998)
bones/29/rotation = Quaternion(-0.0465689, 2.28162e-05, 0.00228446, 0.998913)
bones/31/position = Vector3(-8.08028, 14.5732, 0.110212)
bones/31/rotation = Quaternion(0.660013, -0.328556, 0.455184, 0.499241)
bones/32/position = Vector3(4.42532e-07, 16.939, 5.37133e-06)
bones/32/rotation = Quaternion(0.0342574, -0.0503085, -0.359053, 0.93133)
bones/33/rotation = Quaternion(0.0603549, 0.000111063, -0.580272, 0.812184)
bones/34/position = Vector3(-4.04222e-06, 36.48, 1.50279e-05)
bones/34/rotation = Quaternion(-0.522938, -0.493128, -0.0642848, 0.692263)
bones/35/rotation = Quaternion(0.0292041, 0.0143966, -0.36974, 0.928565)
bones/36/position = Vector3(0.331937, 4.62111, -2.44104e-06)
bones/36/rotation = Quaternion(-0.111247, -0.0396805, 0.0727275, 0.990333)
bones/37/position = Vector3(-0.362216, 4.31791, -5.03434e-06)
bones/37/rotation = Quaternion(-0.127525, -0.00465375, 0.109145, 0.985801)
bones/38/position = Vector3(0.0302887, 3.75892, -2.65241e-05)
bones/39/rotation = Quaternion(-0.131069, -0.00642118, -0.0675348, 0.989049)
bones/40/position = Vector3(0.00412536, 3.75255, -1.20569e-05)
bones/40/rotation = Quaternion(0.0133992, -6.97468e-06, -0.00149078, 0.999909)
bones/41/position = Vector3(-0.0116618, 3.53298, 1.89525e-05)
bones/41/rotation = Quaternion(-0.0202032, 6.30377e-06, 0.00178904, 0.999794)
bones/42/position = Vector3(0.00753021, 3.10955, -1.81794e-06)
bones/43/position = Vector3(1.18173, 11.811, -0.20985)
bones/43/rotation = Quaternion(-0.135036, 0.00828546, -0.00343364, 0.9908)
bones/44/position = Vector3(-0.000615709, 4.11127, 2.73701e-05)
bones/44/rotation = Quaternion(0.00527617, 7.77189e-07, 0.000273784, 0.999986)
bones/45/position = Vector3(-0.000594527, 3.86958, 1.35656e-05)
bones/45/rotation = Quaternion(-0.00633729, 4.2934e-07, -7.99671e-05, 0.99998)
bones/46/position = Vector3(0.00121054, 3.39525, -1.87978e-05)
bones/47/position = Vector3(-1.3627, 12.1622, 0.0885685)
bones/47/rotation = Quaternion(-0.129118, 0.00793086, 0.0347877, 0.990987)
bones/48/position = Vector3(0.0282471, 3.72166, -1.13642e-05)
bones/48/rotation = Quaternion(0.0481673, 1.40499e-05, -0.00309392, 0.998835)
bones/49/position = Vector3(-0.00967073, 3.46855, 8.32502e-06)
bones/49/rotation = Quaternion(-0.0157081, -0.000140378, -0.0022566, 0.999874)
bones/51/rotation = Quaternion(-0.137229, 0.11997, 0.083142, 0.979726)
bones/52/position = Vector3(0.0109272, 3.68791, 1.80771e-05)
bones/52/rotation = Quaternion(0.0588632, -0.000200504, 0.00290227, 0.998262)
bones/53/position = Vector3(0.0110126, 3.11874, -1.03219e-05)
bones/53/rotation = Quaternion(-0.0115178, -0.000159328, -0.00624479, 0.999914)
bones/54/position = Vector3(-0.0219293, 2.75721, 2.68221e-06)
bones/55/rotation = Quaternion(0.179056, 0.297869, 0.933611, -0.0870786)
bones/56/rotation = Quaternion(-0.534726, 0.0994683, -0.0324152, 0.838525)
bones/57/rotation = Quaternion(0.632359, -0.00906902, -0.138551, 0.762131)
bones/58/rotation = Quaternion(0.891717, 0.112887, 0.0332534, 0.437026)
bones/60/rotation = Quaternion(-0.454117, 0.784422, 0.415985, 0.0735951)
bones/61/rotation = Quaternion(-0.923954, -0.102993, 0.0293947, 0.367201)
bones/62/rotation = Quaternion(0.651323, -0.302934, -0.135025, 0.68248)
bones/63/rotation = Quaternion(0.598414, 0.0671853, 0.010352, 0.798298)
bones/64/position = Vector3(2.45869e-06, 8.34585, 5.2154e-08)

[node name="Enemie_1" parent="default_enemy/Armature/Skeleton3D" index="0"]
layers = 65

[node name="Head" type="BoneAttachment3D" parent="default_enemy/Armature/Skeleton3D" index="1"]
transform = Transform3D(0.969245, 0.233027, -0.0791387, -0.0981407, 0.660889, 0.744039, 0.225683, -0.713389, 0.663433, -14.9294, 100.137, -51.1488)
bone_name = "mixamorig_HeadTop_End"
bone_idx = 6

[node name="HeadSensor" type="Area3D" parent="default_enemy/Armature/Skeleton3D/Head"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="default_enemy/Armature/Skeleton3D/Head/HeadSensor"]
transform = Transform3D(1, 1.49012e-08, 1.49012e-08, 2.98023e-08, 1, 5.96046e-08, -7.07805e-08, 2.38419e-07, 1, 0.273796, -7.9536, -11.584)
shape = SubResource("16")

[node name="LeftHand" type="BoneAttachment3D" parent="default_enemy/Armature/Skeleton3D" index="2"]
transform = Transform3D(0.989133, -0.14564, 0.0201553, 0.146961, 0.9752, -0.16549, 0.00444674, 0.166654, 0.986006, 3.58299, 113.02, 1.2545)
bone_name = "mixamorig_LeftHand"
bone_idx = 10

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(-0.5, 0, 4.37114e-08, 0, 0.5, 0, -4.37114e-08, 0, -0.5, 0, 3.01574, 0)
shape = SubResource("1")

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("15")
anim_player = NodePath("../default_enemy/AnimationPlayer")
active = true
parameters/bitting_neck/active = false
parameters/bitting_neck/request = 0
parameters/idle_react/active = false
parameters/idle_react/request = 0
parameters/long_attack/active = false
parameters/long_attack/request = 0
parameters/look_around/active = false
parameters/look_around/request = 0
parameters/motion/blend_amount = 1.0
parameters/space_motion/blend_position = 1.0
parameters/time_scale_motion/scale = 1.0

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]

[node name="Sfx" type="Node3D" parent="."]
script = ExtResource("3")
streamsCategory = {
"screams": ExtResource("5")
}

[node name="RayCastsOrigin" type="Marker3D" parent="."]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 3.26443, 0)

[node name="Bottom" type="RayCast3D" parent="RayCastsOrigin"]
target_position = Vector3(0, -15, 0)
collision_mask = 8
debug_shape_custom_color = Color(1, 0, 0, 1)
debug_shape_thickness = 5

[node name="Top" type="RayCast3D" parent="RayCastsOrigin"]
target_position = Vector3(0, 150, 0)
collision_mask = 12
debug_shape_custom_color = Color(0.921569, 0, 1, 1)
debug_shape_thickness = 5

[node name="Right" type="RayCast3D" parent="RayCastsOrigin"]
target_position = Vector3(-150, 0, 0)
collision_mask = 12
debug_shape_custom_color = Color(0.992157, 1, 0.027451, 1)
debug_shape_thickness = 5

[node name="Left" type="RayCast3D" parent="RayCastsOrigin"]
target_position = Vector3(150, -1, 0)
collision_mask = 12
debug_shape_custom_color = Color(0, 0.0156863, 1, 1)

[node name="Forward" type="RayCast3D" parent="RayCastsOrigin"]
target_position = Vector3(0, 0, 150)
collision_mask = 12
debug_shape_custom_color = Color(0.0431373, 1, 0.12549, 1)

[node name="Backward" type="RayCast3D" parent="RayCastsOrigin"]
target_position = Vector3(0, 0, -150)
collision_mask = 12
debug_shape_custom_color = Color(0, 0.952941, 1, 1)

[node name="AimRay" type="RayCast3D" parent="RayCastsOrigin"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1.64841)
target_position = Vector3(0, 0, 7)
collision_mask = 12
debug_shape_custom_color = Color(0.905882, 0, 0, 1)
debug_shape_thickness = 5

[node name="CloseSight" type="Area3D" parent="."]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 3.35271, 0)
collision_mask = 1024

[node name="CollisionPolygon3D" type="CollisionShape3D" parent="CloseSight"]
shape = SubResource("18")

[node name="FarSight" type="Area3D" parent="."]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 3.35271, 0)
collision_mask = 1024

[node name="CollisionPolygon3D" type="CollisionShape3D" parent="FarSight"]
shape = SubResource("19")

[node name="Debug" type="MeshInstance3D" parent="."]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 10.8536, 0)
material_override = SubResource("21")
mesh = SubResource("20")

[node name="SubViewport" type="SubViewport" parent="Debug"]
transparent_bg = true
size = Vector2i(300, 100)

[node name="Label" type="Label" parent="Debug/SubViewport"]
offset_right = 40.0
offset_bottom = 14.0
size_flags_horizontal = 4
theme_override_fonts/font = ExtResource("4")
text = "STATE"

[editable path="default_enemy"]
