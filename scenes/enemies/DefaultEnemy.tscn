[gd_scene load_steps=27 format=2]

[ext_resource path="res://models/enemies/DefaultEnemy/default_enemy.glb" type="PackedScene" id=1]
[ext_resource path="res://src/Core/Enemies/DefaultEnemy.cs" type="Script" id=2]
[ext_resource path="res://src/Core/Audio/SfxOptions.cs" type="Script" id=3]
[ext_resource path="res://assets/fonts/secondary/secondary_bold_outline.tres" type="FontFile" id=4]
[ext_resource path="res://resources/default_enemy_screams_streams.tres" type="Resource" id=5]

[sub_resource type="SphereShape3D" id=16]
radius = 14.7219

[sub_resource type="CapsuleShape3D" id=1]
radius = 2.62381
height = 11.657

[sub_resource type="AnimationNodeAnimation" id=2]
animation = "mutant_long_attack"

[sub_resource type="AnimationNodeAnimation" id=3]
animation = "mutant_look_around"

[sub_resource type="AnimationNodeAnimation" id=4]
animation = "idle_react"

[sub_resource type="AnimationNodeAnimation" id=5]
animation = "biting_neck"

[sub_resource type="AnimationNodeAnimation" id=6]
animation = "bittingloop"

[sub_resource type="AnimationNodeOneShot" id=7]

[sub_resource type="AnimationNodeOneShot" id=8]

[sub_resource type="AnimationNodeOneShot" id=9]

[sub_resource type="AnimationNodeOneShot" id=10]

[sub_resource type="AnimationNodeBlend2" id=11]

[sub_resource type="AnimationNodeAnimation" id=12]
animation = "crawlingloop"

[sub_resource type="AnimationNodeAnimation" id=13]
animation = "mutant_walkloop"

[sub_resource type="AnimationNodeBlendSpace1D" id=14]
blend_point_0/node = SubResource( 12 )
blend_point_0/pos = 1.0
blend_point_1/node = SubResource( 13 )
blend_point_1/pos = -1.0

[sub_resource type="AnimationNodeTimeScale" id=17]

[sub_resource type="AnimationNodeBlendTree" id=15]
graph_offset = Vector2( -469.302, 36.8561 )
nodes/Animation/node = SubResource( 6 )
nodes/Animation/position = Vector2( -560, 60 )
"nodes/Animation 2/node" = SubResource( 2 )
"nodes/Animation 2/position" = Vector2( 480, 300 )
"nodes/Animation 3/node" = SubResource( 3 )
"nodes/Animation 3/position" = Vector2( -20, 300 )
"nodes/Animation 4/node" = SubResource( 4 )
"nodes/Animation 4/position" = Vector2( 280, 300 )
"nodes/Animation 5/node" = SubResource( 5 )
"nodes/Animation 5/position" = Vector2( 780, 300 )
nodes/bitting_neck/node = SubResource( 7 )
nodes/bitting_neck/position = Vector2( 780, 140 )
nodes/idle_react/node = SubResource( 8 )
nodes/idle_react/position = Vector2( 280, 140 )
nodes/long_attack/node = SubResource( 9 )
nodes/long_attack/position = Vector2( 540, 140 )
nodes/look_around/node = SubResource( 10 )
nodes/look_around/position = Vector2( 40, 140 )
nodes/motion/node = SubResource( 11 )
nodes/motion/position = Vector2( -320, 120 )
nodes/output/position = Vector2( 980, 20 )
nodes/space_motion/node = SubResource( 14 )
nodes/space_motion/position = Vector2( -600, 300 )
nodes/time_scale_motion/node = SubResource( 17 )
nodes/time_scale_motion/position = Vector2( -600, 200 )
node_connections = [ "bitting_neck", 0, "long_attack", "bitting_neck", 1, "Animation 5", "look_around", 0, "motion", "look_around", 1, "Animation 3", "time_scale_motion", 0, "space_motion", "idle_react", 0, "look_around", "idle_react", 1, "Animation 4", "long_attack", 0, "idle_react", "long_attack", 1, "Animation 2", "output", 0, "bitting_neck", "motion", 0, "Animation", "motion", 1, "time_scale_motion" ]

[sub_resource type="ConvexPolygonShape3D" id=18]
points = PackedVector3Array( 36, 10, 36, -36, 10, 36, 0, 2, 0, 36, -5, 36, -36, -5, 36, 0, 0, 0 )

[sub_resource type="ConvexPolygonShape3D" id=19]
points = PackedVector3Array( 80, 10, 80, -80, 10, 80, 0, 2, 0, 80, -5, 80, -80, -5, 80, 0, 0, 0 )

[sub_resource type="StandardMaterial3D" id=21]
flags_transparent = true
flags_unshaded = true
flags_no_depth_test = true
flags_do_not_receive_shadows = true
flags_disable_ambient_light = true
params_billboard_mode = 3
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="QuadMesh" id=20]
size = Vector2( 4, 2 )

[node name="DefaultEnemy" type="CharacterBody3D"]
collision_mask = 12
script = ExtResource( 2 )
aimRayPath = NodePath("RayCastsOrigin/AimRay")
topRayPath = NodePath("RayCastsOrigin/Top")
bottomRayPath = NodePath("RayCastsOrigin/Bottom")
rightRayPath = NodePath("RayCastsOrigin/Right")
leftRayPath = NodePath("RayCastsOrigin/Left")
forwardRayPath = NodePath("RayCastsOrigin/Forward")
backwardRayPath = NodePath("RayCastsOrigin/Backward")
patrolSpeed = 10.0
chasingSpeed = 12.0
huntingSpeed = 14.0
animationTreePath = NodePath("AnimationTree")
sfxPath = NodePath("Sfx")
navigationAgentPath = NodePath("NavigationAgent3D")
closeSightPath = NodePath("CloseSight")
farSightPath = NodePath("FarSight")
headPath = NodePath("default_enemy/Armature/Skeleton3D/Head/HeadSensor")
playerMask = 1032
viewportDebugPath = NodePath("Debug/SubViewport")
labelDebugPath = NodePath("Debug/SubViewport/Label")
meshDebugPath = NodePath("Debug")
rangeToAttack = 8.0
timeAttack = 1.85
attackDamage = 0.1

[node name="default_enemy" parent="." instance=ExtResource( 1 )]
transform = Transform3D( -0.5, 0, -4.37114e-08, 0, 0.5, 0, 4.37114e-08, 0, -0.5, 0, 0, 0 )

[node name="Skeleton3D" parent="default_enemy/Armature" index="0"]
bones/6/bound_children = [ NodePath("Head") ]
bones/10/bound_children = [ NodePath("LeftHand") ]

[node name="Enemie_1" parent="default_enemy/Armature/Skeleton3D" index="0"]
layers = 65

[node name="Head" type="BoneAttachment3D" parent="default_enemy/Armature/Skeleton3D" index="1"]
transform = Transform3D( 0.378976, -0.906569, 0.185767, 0.829763, 0.244013, -0.501947, 0.409721, 0.344368, 0.844712, -63.754, 38.8349, 1.53572 )
bone_name = "mixamorig_HeadTop_End"

[node name="HeadSensor" type="Area3D" parent="default_enemy/Armature/Skeleton3D/Head"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="default_enemy/Armature/Skeleton3D/Head/HeadSensor"]
transform = Transform3D( 1, 1.49012e-08, 1.49012e-08, 2.98023e-08, 1, 5.96046e-08, -7.07805e-08, 2.38419e-07, 1, 0.273796, -7.9536, -11.584 )
shape = SubResource( 16 )

[node name="LeftHand" type="BoneAttachment3D" parent="default_enemy/Armature/Skeleton3D" index="2"]
transform = Transform3D( 0.355985, -0.637033, 0.683714, 0.885926, -0.00273732, -0.463819, 0.297339, 0.770832, 0.563389, -42.4436, 58.4747, -20.9049 )
bone_name = "mixamorig_LeftHand"

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D( -0.5, -4.37114e-08, 1.91069e-15, 0, -2.18557e-08, -0.5, 4.37114e-08, -0.5, 2.18557e-08, 0, 5.04857, 1.01498 )
shape = SubResource( 1 )

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource( 15 )
anim_player = NodePath("../default_enemy/AnimationPlayer")
active = true
parameters/bitting_neck/active = false
parameters/idle_react/active = false
parameters/long_attack/active = false
parameters/look_around/active = false
parameters/motion/blend_amount = 0.0
parameters/space_motion/blend_position = 1.0
parameters/time_scale_motion/scale = 1.0

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]

[node name="Sfx" type="Node3D" parent="."]
script = ExtResource( 3 )
streamsCategory = {
"screams": ExtResource( 5 )
}

[node name="RayCastsOrigin" type="Marker3D" parent="."]
transform = Transform3D( -1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 3.26443, 0 )

[node name="Bottom" type="RayCast3D" parent="RayCastsOrigin"]
enabled = true
target_position = Vector3( 0, -15, 0 )
collision_mask = 8
debug_shape_custom_color = Color( 1, 0, 0, 1 )
debug_shape_thickness = 5

[node name="Top" type="RayCast3D" parent="RayCastsOrigin"]
enabled = true
target_position = Vector3( 0, 150, 0 )
collision_mask = 12
debug_shape_custom_color = Color( 0.921569, 0, 1, 1 )
debug_shape_thickness = 5

[node name="Right" type="RayCast3D" parent="RayCastsOrigin"]
enabled = true
target_position = Vector3( -150, 0, 0 )
collision_mask = 12
debug_shape_custom_color = Color( 0.992157, 1, 0.027451, 1 )
debug_shape_thickness = 5

[node name="Left" type="RayCast3D" parent="RayCastsOrigin"]
enabled = true
target_position = Vector3( 150, -1, 0 )
collision_mask = 12
debug_shape_custom_color = Color( 0, 0.0156863, 1, 1 )

[node name="Forward" type="RayCast3D" parent="RayCastsOrigin"]
enabled = true
target_position = Vector3( 0, 0, 150 )
collision_mask = 12
debug_shape_custom_color = Color( 0.0431373, 1, 0.12549, 1 )

[node name="Backward" type="RayCast3D" parent="RayCastsOrigin"]
enabled = true
target_position = Vector3( 0, 0, -150 )
collision_mask = 12
debug_shape_custom_color = Color( 0, 0.952941, 1, 1 )

[node name="AimRay" type="RayCast3D" parent="RayCastsOrigin"]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1.64841 )
enabled = true
target_position = Vector3( 0, 0, 7 )
collision_mask = 12
debug_shape_custom_color = Color( 0.905882, 0, 0, 1 )
debug_shape_thickness = 5

[node name="CloseSight" type="Area3D" parent="."]
transform = Transform3D( -1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 3.35271, 0 )
collision_mask = 1024

[node name="CollisionPolygon3D" type="CollisionShape3D" parent="CloseSight"]
shape = SubResource( 18 )

[node name="FarSight" type="Area3D" parent="."]
transform = Transform3D( -1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 3.35271, 0 )
collision_mask = 1024

[node name="CollisionPolygon3D" type="CollisionShape3D" parent="FarSight"]
shape = SubResource( 19 )

[node name="Debug" type="MeshInstance3D" parent="."]
transform = Transform3D( -1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 10.8536, 0 )
material_override = SubResource( 21 )
mesh = SubResource( 20 )

[node name="SubViewport" type="SubViewport" parent="Debug"]
size = Vector2( 300, 100 )
transparent_bg = true
render_target_v_flip = true

[node name="Label" type="Label" parent="Debug/SubViewport"]
offset_right = 40.0
offset_bottom = 14.0
size_flags_horizontal = 4
theme_override_fonts/font = ExtResource( 4 )
text = "STATE"

[editable path="default_enemy"]
