[gd_scene load_steps=20 format=2]

[ext_resource path="res://models/weapons/pistol_bufallus/pistol_taurus.glb" type="PackedScene" id=1]
[ext_resource path="res://src/Core/Items/Weapons/Pistol.cs" type="Script" id=2]
[ext_resource path="res://assets/vfx/muzzle.jpg" type="Texture2D" id=3]
[ext_resource path="res://src/Core/Audio/SfxOptions.cs" type="Script" id=4]
[ext_resource path="res://assets/sfx/reload.mp3" type="AudioStream" id=5]
[ext_resource path="res://assets/sfx/9mm-pistol-shot.wav" type="AudioStream" id=6]
[ext_resource path="res://scenes/ammo/BulletCapsule.tscn" type="PackedScene" id=7]
[ext_resource path="res://assets/sfx/empty_pistol.wav" type="AudioStream" id=8]
[ext_resource path="res://scenes/firearm_clips/PistolBufallusClip.tscn" type="PackedScene" id=9]
[ext_resource path="res://scenes/decals/ShotDecal.tscn" type="PackedScene" id=10]
[ext_resource path="res://assets/shaders/muzzle.gdshader" type="Shader" id=11]

[sub_resource type="BoxShape3D" id=12]
size = Vector3( 0.212333, 0.664947, 0.854965 )

[sub_resource type="ShaderMaterial" id=7]
shader = ExtResource( 11 )
shader_param/albedo = Color( 1, 1, 1, 1 )
shader_param/specular = 0.5
shader_param/metallic = 0.0
shader_param/roughness = 1.0
shader_param/point_size = 1.0
shader_param/particles_anim_h_frames = 1
shader_param/particles_anim_v_frames = 1
shader_param/particles_anim_loop = false
shader_param/emission = Color( 1, 0.92549, 0.521569, 1 )
shader_param/emission_energy = 1.0
shader_param/uv1_scale = Vector3( 1, 1, 1 )
shader_param/uv1_offset = Vector3( 0, 0, 0 )
shader_param/uv2_scale = Vector3( 1, 1, 1 )
shader_param/uv2_offset = Vector3( 0, 0, 0 )
shader_param/texture_albedo = ExtResource( 3 )

[sub_resource type="ParticleProcessMaterial" id=4]
gravity = Vector3( 0, 0, 0 )
angle = 360.0
angle_random = 1.0

[sub_resource type="QuadMesh" id=5]
size = Vector2( 1.2, 1.2 )

[sub_resource type="StandardMaterial3D" id=9]
flags_unshaded = true
flags_do_not_receive_shadows = true
flags_disable_ambient_light = true
albedo_color = Color( 1, 0, 0, 1 )

[sub_resource type="SphereMesh" id=10]
radius = 0.5
height = 1.0
radial_segments = 6
rings = 2

[sub_resource type="StandardMaterial3D" id=11]
flags_unshaded = true
flags_do_not_receive_shadows = true
flags_disable_ambient_light = true
albedo_color = Color( 1, 0.156863, 0.156863, 1 )

[sub_resource type="Animation" id=1]
resource_name = "shoot"
length = 0.1
tracks/0/type = "value"
tracks/0/path = NodePath("OmniLight3D:light_energy")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PackedFloat32Array( 0.00465851, 0.1 ),
"transitions": PackedFloat32Array( 1, 1 ),
"update": 1,
"values": [ 4.0, 0.0 ]
}

[node name="PistolBufallus" type="RigidBody3D"]
collision_layer = 32
collision_mask = 4108
mode = 3
script = ExtResource( 2 )
meshesHolderPath = NodePath("pistol_taurus")
defaultLayer = 1
layerHighlight = 64
itemId = "PistolBufallus"
animPlayerPath = NodePath("AnimationPlayer")
muzzleFlashParticlesPath = NodePath("MuzzleParticles")
sxfPath = NodePath("Sfx")
capsulePositionPath = NodePath("CapsulesDropPos")
slidePath = NodePath("pistol_taurus/Parte Superior")
capsule9mm = ExtResource( 7 )
capsuleDropSpeed = 5.0
acceptedClipTypes = [ 0 ]
clipPosPath = NodePath("ClipPost")
bulletDecal = ExtResource( 10 )
bulletFromPath = NodePath("BulletFrom")
bulletRange = 600.0
laserPath = NodePath("Laser")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.175122, 0.0288309 )
shape = SubResource( 12 )

[node name="pistol_taurus" parent="." instance=ExtResource( 1 )]

[node name="OmniLight3D" type="OmniLight3D" parent="."]
light_energy = 0.0
light_indirect_energy = 2.0
omni_range = 7000.0

[node name="MuzzleParticles" type="Particles" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.272408, 1.09818 )
material_override = SubResource( 7 )
emitting = false
amount = 1
lifetime = 0.02
one_shot = true
explosiveness = 1.0
process_material = SubResource( 4 )
draw_pass_1 = SubResource( 5 )

[node name="Sfx" type="Node3D" parent="."]
script = ExtResource( 4 )
streams = {
"cock": ExtResource( 5 ),
"empty": ExtResource( 8 ),
"shoot": ExtResource( 6 )
}

[node name="CapsulesDropPos" type="Marker3D" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0682787, 0.394797, 0 )

[node name="ClipPost" type="Marker3D" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.863404, -0.489844 )

[node name="PistolBufallusClip" parent="ClipPost" instance=ExtResource( 9 )]

[node name="BulletFrom" type="Marker3D" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.260995, 0.965901 )

[node name="LeftHandPosition" type="Marker3D" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.366607, -0.898933, -0.481612 )

[node name="Laser" type="ImmediateMesh" parent="."]
transform = Transform3D( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.266943, 2.16349 )
visible = false
material_override = SubResource( 9 )

[node name="MeshInstance3D" type="MeshInstance3D" parent="Laser"]
mesh = SubResource( 10 )
material/0 = SubResource( 11 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
anims/shoot = SubResource( 1 )

[editable path="pistol_taurus"]
